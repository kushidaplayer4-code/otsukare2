<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>間違い探し</title>
<style>
body {
  font-family: sans-serif;
  text-align: center;
  padding: 10px;
  margin: 0;
  background: #fff;
}

.game-area {
  position: relative;
  display: inline-block;
}

img {
  width: 90vw;
  max-width: 400px;
  border: 2px solid #000;
  display: block;
  margin-bottom: 10px;
}

.marker {
  position: absolute;
  width: 32px;
  height: 32px;
  border: 3px solid red;
  border-radius: 50%;
  pointer-events: none;
  transform: translate(-50%, -50%);
  animation: pop 0.25s ease-out;
}

@keyframes pop {
  0% { transform: translate(-50%, -50%) scale(0); }
  100% { transform: translate(-50%, -50%) scale(1); }
}

#message {
  margin-top: 12px;
  padding: 10px;
  font-size: 16px;
  background: #f5f5f5;
  border-radius: 8px;
  min-height: 2.5em;
}

#overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255,255,255,0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  flex-direction: column;
  font-size: 24px;
  font-weight: bold;
  text-align: center;
  display: none;
  animation: sparkle 1.5s infinite;
}

@keyframes sparkle {
  0%,100% { background: rgba(255,255,255,0.7); }
  50% { background: rgba(255,255,255,0.85); }
}
</style>
</head>
<body>

<h2>間違い探し</h2>
<p>2枚の画像を比べて、違うところをタップ！</p>

<div class="game-area" id="gameArea">
  <img src="image1.JPG" alt="画像A" id="img1">
  <img src="image2.PNG" id="img2" alt="画像B（間違いあり）">
</div>

<div id="message">どこが違うかな？</div>

<div id="overlay">お疲れ様でした。<br>宮城県の治安を守ってください。</div>

<script>
// 正解の座標と文章
const differences = [
  {
    x1: 229, y1: 11, x2: 322, y2: 108,
    found: false,
    text: "ディズニーランドじゃないのに耳つけてて浮かれてるね！"
  },
  {
    x1: 126, y1: 201, x2: 185, y2: 252,
    found: false,
    text: "いやらしい本を見てにやにやしているね！"
  },
  {
    x1: 284, y1: 299, x2: 312, y2: 323,
    found: false,
    text: "カバンに職場のロゴをつけていて忠誠心抜群だ！"
  }
];

const img1 = document.getElementById("img1");
const img2 = document.getElementById("img2");
const gameArea = document.getElementById("gameArea");
const message = document.getElementById("message");
const overlay = document.getElementById("overlay");

img2.addEventListener("click", (e) => {
  const rect = img2.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;

  let correct = false;

  for (const diff of differences) {
    if (!diff.found && x >= diff.x1 && x <= diff.x2 && y >= diff.y1 && y <= diff.y2) {
      diff.found = true;
      correct = true;

      // 正解文章表示
      message.textContent = diff.text;

      // バイブ
      if (navigator.vibrate) navigator.vibrate(200);

      // 赤丸を両方の画像に表示
      [img1, img2].forEach(img => {
        const imgRect = img.getBoundingClientRect();
        const marker = document.createElement("div");
        marker.className = "marker";
        marker.style.left = `${x}px`;
        marker.style.top = `${y}px`;
        marker.style.position = "absolute";
        img.parentElement.appendChild(marker);
      });

      break;
    }
  }

  // 間違いタップ
  if (!correct) {
    message.textContent = "ちがうよ！";
  }

  // クリア判定
  if (differences.every(d => d.found)) {
    overlay.style.display = "flex";
  }
});
</script>

</body>
</html>
